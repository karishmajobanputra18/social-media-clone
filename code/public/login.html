<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/login.css">
    <title>Log In</title>
</head>
<body >
    <style>
        body{
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            
        }
        form label{
            display: flex;
            flex-direction: row;
           justify-content: center;
           align-items: center;
        }
    </style>
    <header>
    <h1>Log in</h1> 
    </header>
<nav class="navBar">
<a href="index.html">Home</a>
<a href="posts.html">Timeline</a>
<a href="login.html"></a>
</nav>

    <form id="loginform" name="login" >
        
        <label for="username">Username</label>
        <input id="username" type="text" name="username" placeholder="Username" autofocus>
        
        
        <label for="password">Password</label>
        <input id="password" type="text" name="password" placeholder="Password" autofocus>
       
        <input type="submit" value="Submit"/>
    </form>

    
<script type="text/javascript">
         let formData = document.getElementById('loginform');
         let username =  document.getElementById("username");
        let password = document.getElementById("password");

//makes request for api in index.js
    function callApi(url, data) {
        form.addEventListener("submit", (event) => {
		event.preventDefault();
        let formData=new FormData(form);
        let url = '/api/LogIn'
        let data;{
            let username = formData.get("username");
            let password = formData.get("password");
        }
        let options = {
            method: "POST",
            headers:{
                "Content-Type":"application/json"
            },
        
            body:util.FormDataJson(data)
        }
        return fetch(url);
        (response=> response.json())
     
        	})	// Add submit event listener to Stop the submit button sending the form
    
    
    
     
   
	  
        .then(response => {
            response.json().then(result => {
                console.log(result)
         if (result && result.token) {
                        window.sessionStorage.setItem('token', result.token)
                        window.sessionStorage.setItem('username', result.username)
                        // Redirect to home page
                        window.location = '/posts.html'
         }
         else{
             error.insertAdjacentHTML("beforeend","Username or password is incorrect");
         }
        })
    })
        }
    
		//tell user if they are logged in/out
        
			
	

    		 
   
	
    </script>
</body>
</html>
